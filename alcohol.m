t=[.25,.5,.75,1,1.5,2,2.5,3,3.5,4,4.5,5,6,7,8,9,10,11,12,13,14,15,16];
ct=[30,68,75,82,84,77,70,68,58,51,50,41,38,35,28,25,18,15,12,10,7,7,4];
fun=@(x,xdata)x(1)*exp(x(2)*xdata)-x(3)*exp(x(4)*xdata);
x0=[100,-1,100,-1];
x=lsqcurvefit(fun,x0,t,ct);
ct_predict=@(t)x(1)*exp(x(2)*t)-x(3)*exp(x(4)*t);
plot(t,ct,'o',[0.1:0.1:20],ct_predict([0.1:0.1:20]),'-b');
%ct=110.5528*exp(-0.1795*t)+151.4539*exp(-2.8242*t)
%p2
fun2=@(t)3/2*(x(1)*exp(x(2)*t)-x(3)*exp(x(4)*t))-20;
x1=fzero(fun2,0.2);
x2=fzero(fun2,10);
plot([0.1:0.1:20],fun2([0.1:0.1:20]));
hold on;
plot(x1,fun2(x1),'o');
plot(x2,fun2(x2),'o');
%3
dy=@(t)(x(2)*x(1)*exp(x(2)*t)-x(4)*x(3)*exp(x(4)*t));
max_t=fzero(dy,1);